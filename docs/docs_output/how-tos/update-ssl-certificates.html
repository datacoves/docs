<!DOCTYPE html>
<html lang="en">
 <head>
  <!-- Google Tag Manager -->
  <script>
   (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5P9ZRRG');
  </script>
  <!-- End Google Tag Manager -->
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <link data-rh="true" href="/assets/favicon.ico" rel="icon"/>
  <meta content="width=device-width, initial-scale=1, minimum-scale=1.0, shrink-to-fit=no, viewport-fit=cover" name="viewport"/>
  <meta content="Datacoves documentation" name="Datacoves Docs"/>
  <title>
   Datacoves Docs
  </title>
  <meta content="Start your journey with the Datacoves platform: See essential guides for onboarding or key resources for DataOps, dbt, Airflow, VS Code support and more." name="description"/>
  <!-- Themes (light + dark) -->
  <link href="https://cdn.jsdelivr.net/npm/docsify-themeable@0/dist/css/theme-simple.css" media="(prefers-color-scheme: dark)" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/docsify-themeable@0/dist/css/theme-simple.css" media="(prefers-color-scheme: light)" rel="stylesheet"/>
  <link href="/assets/pygment.css" rel="stylesheet"/>
  <!-- Custom Styles -->
  <style>
   :root {
        --cover-heading-color: #00044a;
        --cover-blockquote-color: #00044a;
      }
      .sidebar-nav a {
        white-space: normal;
      }
      /* selector for "edit on github" link */
      .markdown-section p[style*="float: right"] {
        position: fixed;
        bottom: 0px;
        right: 20px;
      }
      @media (max-width: 480px) {
        .app-nav {
          display: none;
        }
        /* selector for "edit on github" link */
        .markdown-section p[style*="float: right"] {
          display: none;
        }
      }
  </style>
  <style type="text/css">
   .medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}
  </style>
  <style type="text/css">
   .docsify-pagination-container{display:flex;flex-wrap:wrap;justify-content:space-between;overflow:hidden;margin:5em 0 1em;border-top:1px solid rgba(0,0,0,.07)}.pagination-item{margin-top:2.5em}.pagination-item a,.pagination-item a:hover{text-decoration:none}.pagination-item a{color:currentColor}.pagination-item a:hover .pagination-item-title{text-decoration:underline}.pagination-item:not(:last-child) a .pagination-item-label,.pagination-item:not(:last-child) a .pagination-item-subtitle,.pagination-item:not(:last-child) a .pagination-item-title{opacity:.3;transition:all .2s}.pagination-item:last-child .pagination-item-label,.pagination-item:not(:last-child) a:hover .pagination-item-label{opacity:.6}.pagination-item:not(:last-child) a:hover .pagination-item-title{opacity:1}.pagination-item-label{font-size:.8em}.pagination-item-label>*{line-height:1;vertical-align:middle}.pagination-item-label svg{height:.8em;width:auto;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1px}.pagination-item--next{margin-left:auto;text-align:right}.pagination-item--next svg{margin-left:.5em}.pagination-item--previous svg{margin-right:.5em}.pagination-item-title{font-size:1.6em}.pagination-item-subtitle{text-transform:uppercase;opacity:.3}
  </style>
  <style type="text/css">
   .sidebar-nav > ul > li ul {
      display: none;
    }

    .app-sub-sidebar {
      display: none;
    }

    .app-sub-sidebar.open {
      display: block;
    }

    .sidebar-nav .open > ul:not(.app-sub-sidebar),
    .sidebar-nav .active:not(.collapse) > ul {
      display: block;
    }

    .sidebar-nav li.open:not(.collapse) > ul {
      display: block;
    }

    .active + ul.app-sub-sidebar {
      display: block;
    }
  </style>
  <style type="text/css">
   @media screen and (max-width: 768px) {
      .markdown-section {
        max-width: none;
        padding: 16px;
      }
      .sidebar-toggle {
        padding: 0 0 10px 10px;
      }
      /* my pin */
      .sidebar-pin {
        appearance: none;
        outline: none;
        position: fixed;
        bottom: 0;
        border: none;
        width: 40px;
        height: 40px;
        background: transparent;
      }
    }
  </style>
  <style type="text/css">
   .alert{word-wrap:break-word;display:block;margin-bottom:1rem!important;padding:.75rem 1.25rem!important;position:relative;word-break:break-word}.alert>*{max-width:100%}.alert>:first-child{margin-top:0}.alert>:last-child{margin-bottom:0}.alert:before{content:unset!important}.alert+.alert{margin-top:-.25rem!important}.alert p{margin-bottom:.5rem;margin-top:.5rem}.alert .title{align-items:center;display:flex;flex-wrap:wrap;font-weight:600;margin:0}.icon{background-repeat:no-repeat;display:inline-block;height:16px;margin-right:.5rem;width:16px}.alert.callout{background:var(--background);border:1px solid #eee;border-left-width:.25rem;border-radius:.25rem}.alert.callout.note{border-left-color:#17a2b8!important}.alert.callout.note .title{color:#17a2b8}.alert.callout.note .icon-note{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 16 16' fill='%2317a2b8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2z'/%3E%3C/svg%3E")}.alert.callout.tip{border-left-color:#28a745!important}.alert.callout.tip .title{color:#28a745}.alert.callout.tip .icon-tip{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 352 512' fill='%2328a745' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z'/%3E%3C/svg%3E")}.alert.callout.warning{border-left-color:#f0ad4e!important}.alert.callout.warning .title{color:#f0ad4e}.alert.callout.warning .icon-warning{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 17 16' fill='%23f0ad4e' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 5zm.002 6a1 1 0 1 0 0 2 1 1 0 0 0 0-2z'/%3E%3C/svg%3E")}.alert.callout.attention{border-left-color:#dc3545!important}.alert.callout.attention .title{color:#dc3545}.alert.callout.attention .icon-attention{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 16 16' fill='%23dc3545' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/%3E%3Cpath fill-rule='evenodd' d='M11.354 4.646a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708l6-6a.5.5 0 0 1 .708 0z'/%3E%3C/svg%3E")}.alert.flat{background-color:#e2e3e5;border:1px solid #d6d8db;border-radius:.125rem;color:#383d41}.alert.flat.note{background-color:#cdeefd;border-color:#b4e6fc;color:#02587f}.alert.flat.note .title{color:#01354d}.alert.flat.note .icon-note{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 16 16' fill='%2301354d' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2z'/%3E%3C/svg%3E")}.alert.flat.tip{background-color:#dbefdc;border-color:#c9e7cb;color:#285b2a}.alert.flat.tip .title{color:#18381a}.alert.flat.tip .icon-tip{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 352 512' fill='%2318381a' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z'/%3E%3C/svg%3E")}.alert.flat.warning{background-color:#ffddd3;border-color:#ffc9ba;color:#852d12}.alert.flat.warning .title{color:#581e0c}.alert.flat.warning .icon-warning{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 17 16' fill='%23581e0c' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 5zm.002 6a1 1 0 1 0 0 2 1 1 0 0 0 0-2z'/%3E%3C/svg%3E")}.alert.flat.attention{background-color:#fdd9d7;border-color:#fcc2bf;color:#7f231c}.alert.flat.attention .title{color:#551713}.alert.flat.attention .icon-attention{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='1em' height='1em' viewBox='0 0 16 16' fill='%23551713' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' d='M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/%3E%3Cpath fill-rule='evenodd' d='M11.354 4.646a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708l6-6a.5.5 0 0 1 .708 0z'/%3E%3C/svg%3E")}
  </style>
  <style>
   #mb-footer { border-top: 1px solid; font-size: 0.8em; line-height: 1.5; transition: all var(--sidebar-transition-duration) ease-out; }#mb-footer { padding-top: 1.5rem; margin-top: 1.5rem; } #mb-footer .footer-text, #mb-footer .footer-text a { font-weight: bold; }
  </style>
  <style>
   .sidebar {
      padding-top: 0;
    }

    .search {
      margin-bottom: 20px;
      padding: 6px;
      border-bottom: 1px solid #eee;
    }

    .search .input-wrap {
      display: flex;
      align-items: center;
    }

    .search .results-panel {
      display: none;
    }

    .search .results-panel.show {
      display: block;
    }

    .search input {
      outline: none;
      border: none;
      width: 100%;
      padding: 0.6em 7px;
      font-size: inherit;
      border: 1px solid transparent;
    }

    .search input:focus {
      box-shadow: 0 0 5px var(--theme-color, #42b983);
      border: 1px solid var(--theme-color, #42b983);
    }

    .search input::-webkit-search-decoration,
    .search input::-webkit-search-cancel-button,
    .search input {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }

    .search input::-ms-clear {
      display: none;
      height: 0;
      width: 0;
    }

    .search .clear-button {
      cursor: pointer;
      width: 36px;
      text-align: right;
      display: none;
    }

    .search .clear-button.show {
      display: block;
    }

    .search .clear-button svg {
      transform: scale(.5);
    }

    .search h2 {
      font-size: 17px;
      margin: 10px 0;
    }

    .search a {
      text-decoration: none;
      color: inherit;
    }

    .search .matching-post {
      border-bottom: 1px solid #eee;
    }

    .search .matching-post:last-child {
      border-bottom: 0;
    }

    .search p {
      font-size: 14px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .search p.empty {
      text-align: center;
    }

    .app-name.hide, .sidebar-nav.hide {
      display: none;
    }
  </style>
 </head>
 <body class="ready sticky ready-fix">
  <!-- Google Tag Manager (noscript) -->
  <noscript>
   <iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-5P9ZRRG" style="display:none;visibility:hidden" width="0">
   </iframe>
  </noscript>
  <!-- End Google Tag Manager (noscript) -->
  <nav class="app-nav no-badge">
   <!-- These links should have target = _blank -->
   <!--
            <ul>
                <li>
                    <p>
                        <a href="https://datacoves.com/learning-resources" target="_blank" rel="noopener" title="Learning Resources">Learning Resources</a>
                    </p>
                </li>
                <li>
                    <p>
                        <a href="https://github.com/datacoves/" target="_blank" rel="noopener" title="Our git repos">Our git repos</a>
                    </p>
                </li>
                <li>
                    <p>
                        <a href="https://docs.getdbt.com/" target="_blank" rel="noopener" title="dbt docs">dbt docs</a>
                    </p>
                </li>
            </ul>
            -->
   <ul>
    <li>
     <p>
      <a href="https://datacoves.com/learning-resources">
       Learning Resources
      </a>
     </p>
    </li>
    <li>
     <p>
      <a href="https://github.com/datacoves/">
       Our git repos
      </a>
     </p>
    </li>
    <li>
     <p>
      <a href="https://docs.getdbt.com/">
       dbt docs
      </a>
     </p>
    </li>
   </ul>
  </nav>
  <main>
   <button aria-label="Menu" class="sidebar-toggle">
    <div class="sidebar-toggle-button">
     <span>
     </span>
     <span>
     </span>
     <span>
     </span>
    </div>
   </button>
   <aside class="sidebar">
    <div class="search">
     <div class="input-wrap">
      <input aria-label="Search text" id="searchbox" placeholder="Type to search" type="search" value=""/>
      <button aria-label="Clear search" class="clear-button">
       <svg height="16" viewbox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">
        <circle cx="8" cy="8" fill="black" r="8">
        </circle>
        <path d="M4.5,4.5,11.5,11.5" stroke="white" stroke-width="1.5" vector-effect="non-scaling-stroke">
        </path>
        <path d="M4.5,11.5,11.5,4.5" stroke="white" stroke-width="1.5" vector-effect="non-scaling-stroke">
        </path>
       </svg>
      </button>
     </div>
     <div class="results-panel" id="resultsbox">
     </div>
    </div>
    <a name="">
    </a>
    <h1 class="app-name">
     <a class="app-name-link" data-nosearch="" href="/">
      <img alt="Datacoves Docs" src="/assets/dc-logo.svg"/>
     </a>
    </h1>
    <div class="sidebar-nav">
     <ul>
      <li>
       <p>
        <a href="/">
         Home
        </a>
       </p>
      </li>
      <li>
       <p>
        <a href="/client-docs/">
         Client Docs
        </a>
       </p>
       <ul>
        <li>
         <a href="/client-docs/jnj/">
          J&amp;J
         </a>
         <ul>
          <li>
           <a href="/client-docs/jnj/1-cluster-requirements.html">
            Cluster Requirements
           </a>
          </li>
          <li>
           <a href="/client-docs/jnj/2-configuration.html">
            Configuration
           </a>
          </li>
          <li>
           <a href="/client-docs/jnj/3-configure-bastion-ec2-instance.html">
            Configure Bastion EC2 Instance
           </a>
          </li>
          <li>
           <a href="/client-docs/jnj/4-configure-bitbucket-and-jenkins.html">
            Configure Bitbucket and Jenkins
           </a>
          </li>
          <li>
           <a href="/client-docs/jnj/5-deployment.html">
            Deployment
           </a>
          </li>
          <li>
           <a href="/client-docs/jnj/6-access.html">
            Access
           </a>
          </li>
          <li>
           <a href="/client-docs/jnj/7-configure-sa-docker-in-kubernates.html">
            Configure Docker SA in K8S
           </a>
          </li>
          <li>
           <a href="/client-docs/jnj/8-summary-requirements-new-cluster.html">
            Summary of Reqs for new Cluster
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="/client-docs/orrum.html">
          Orrum
         </a>
         <strong>
          Dev Logs
         </strong>
        </li>
       </ul>
      </li>
      <li>
       <a href="/dev-logs/">
        Dev Logs
       </a>
       <ul>
        <li>
         <a href="/dev-logs/2021-06-create-er-diagram.html">
          2021-06 Create ER Diagram
         </a>
        </li>
        <li>
         <a href="/dev-logs/2021-09-eks-setup.html">
          2021-09 EKS Setup
         </a>
        </li>
        <li>
         <a href="/dev-logs/2021-12-jnj-ensembledev-deployment.html">
          2021-12 JNJ Ensembledev Deployment
         </a>
        </li>
        <li>
         <a href="/dev-logs/2022-04-jnj-artemisdev-configuration.html">
          2022-04 Artemisdev Configuration
         </a>
        </li>
        <li>
         <a href="/dev-logs/2022-04-jnj-ensembletest-deployment.html">
          2022-04 Ensembletest Deployment
         </a>
        </li>
        <li>
         <a href="/dev-logs/2022-05-setup-aks-postgres-flexible-server.html">
          2022-05 Setup AKS Postgres Flexible Server
         </a>
         <strong>
          How-To
         </strong>
        </li>
       </ul>
      </li>
      <li>
       <a href="/how-tos/">
        How-To
       </a>
       <ul>
        <li>
         <a href="/how-tos/administrate-east-us-a-aks-cluster.html">
          Administrate East US A AKS Cluster
         </a>
        </li>
        <li>
         <a href="/how-tos/airflow-configuration.html">
          Airflow Configuration
         </a>
        </li>
        <li>
         <a href="/how-tos/celery-monitoring.html">
          Celery Monitoring
         </a>
        </li>
        <li>
         <a href="/how-tos/choose-ec2-nodes.html">
          Choose EC2 Nodes
         </a>
        </li>
        <li>
         <a href="/how-tos/connect-to-kenvue-cluster-using-a-bastion.html">
          Connect to Kenvue Cluster Using a Bastion
         </a>
        </li>
        <li>
         <a href="/how-tos/datacoves-versioning.html">
          Datacoves Versioning
         </a>
        </li>
        <li>
         <a href="/how-tos/debug-airflow-workers.html">
          Debug Airflow Workers
         </a>
        </li>
        <li>
         <a href="/how-tos/debug-dbt-errors-when-return-code-is-not-zero.html">
          Debug DBT Errors When Return Code is Not Zero
         </a>
        </li>
        <li>
         <a href="/how-tos/grafana-grant-permisions.html">
          Grafana Grant Permissions
         </a>
        </li>
        <li>
         <a href="/how-tos/grafana-loki-storage-config-providers.html">
          Grafana Loki Storage Config Providers
         </a>
        </li>
        <li>
         <a href="/how-tos/grafana-loki-storage-config.html">
          Grafana Loki Storage Config
         </a>
        </li>
        <li>
         <a href="/how-tos/hotfix.html">
          Hotfix
         </a>
        </li>
        <li>
         <a href="/how-tos/how-to-create-a-ssl-certificate.html">
          How to Create a SSL Certificate
         </a>
        </li>
        <li>
         <a href="/how-tos/install-python-reqs-on-jnj-bastion.html">
          Install Python Reqs on JNJ Bastion
         </a>
        </li>
        <li>
         <a href="/how-tos/list-code-server-pods-processes.html">
          List Code Server Pods Processes
         </a>
        </li>
        <li>
         <a href="/how-tos/make-and-install-a-release.html">
          Make and Install a Release
         </a>
        </li>
        <li>
         <a href="/how-tos/manage-profiles-and-image-sets.html">
          Manage Profiles and Image Sets
         </a>
        </li>
        <li>
         <a href="/how-tos/move-a-gpg-secret-key.html">
          Move a GPG Secret Key
         </a>
        </li>
        <li>
         <a href="/how-tos/onboard-a-new-project-on-datacoves.html">
          Onboard a New Project on Datacoves
         </a>
        </li>
        <li>
         <a href="/how-tos/prometheus-queries.html">
          Prometheus Queries
         </a>
        </li>
        <li>
         <a href="/how-tos/q-and-a.html">
          Q and A
         </a>
        </li>
        <li>
         <a href="/how-tos/register-github-self-hosted-runner.html">
          Register GitHub Self Hosted Runner
         </a>
        </li>
        <li>
         <a href="/how-tos/release-notes.html">
          Release Notes
         </a>
        </li>
        <li>
         <a href="/how-tos/request-access-to-a-cloud-pc-on-kenvue.html">
          Request Access to a Cloud PC on Kenvue
         </a>
        </li>
        <li>
         <a href="/how-tos/security-vulnerabilities-fix.html">
          Security Vulnerabilities Fix
         </a>
        </li>
        <li>
         <a href="/how-tos/set-maintenance-mode.html">
          Set Maintenance Mode
         </a>
        </li>
        <li>
         <a href="/how-tos/setup-s3-for-dbt-api.html">
          Setup S3 for DBT API
         </a>
        </li>
        <li>
         <a href="/how-tos/testing-alerts.html">
          Testing Alerts
         </a>
        </li>
        <li>
         <a href="/how-tos/trigger-cloudx-pipeline-on-kenvue-cluster.html">
          Trigger CloudX Pipeline on Kenvue Cluster
         </a>
        </li>
        <li>
         <a href="/how-tos/update-kubernetes-and-datacoves.html">
          Update Kubernetes and Datacoves
         </a>
        </li>
        <li>
         <a href="/how-tos/update-ssl-certificates.html">
          Update SSL Certificates
         </a>
        </li>
        <li>
         <a href="/how-tos/upgrade-dbt-or-related-tools.html">
          Upgrade DBT or Related Tools
         </a>
        </li>
        <li>
         <a href="/how-tos/work-on-a-pre-release-locally.html">
          Work on a Pre Release Locally
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="/implementation/">
        Implementation
       </a>
       <ul>
        <li>
         <a href="/implementation/operator.html">
          Operator
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="/issues-resolutions/">
        Issues Resolutions
       </a>
       <ul>
        <li>
         <a href="/issues-resolutions/airflow-corrupted-dag-logs.html">
          Airflow Corrupted DAG Logs
         </a>
        </li>
        <li>
         <a href="/issues-resolutions/dbt-core-debugging.html">
          DBT Core Debugging
         </a>
        </li>
        <li>
         <a href="/issues-resolutions/docker-image-debugging.html">
          Docker Image Debugging
         </a>
        </li>
        <li>
         <a href="/issues-resolutions/docker-push-stopped-working.html">
          Docker Push Stopped Working
         </a>
        </li>
        <li>
         <a href="/issues-resolutions/helm-chart.html">
          Helm Chart
         </a>
        </li>
        <li>
         <a href="/issues-resolutions/pomerium-not-allowing-access.html">
          Pomerium Not Allowing Access
         </a>
        </li>
       </ul>
      </li>
     </ul>
     <footer id="mb-footer">
     </footer>
     <footer class="keeper" id="mb-footer">
      <div class="footer-container">
       <div class="footer-text">
        <span class="footer-text-copyright">
         Copyright © 2021-2024
        </span>
        <span class="footer-text-author">
         <a href="https://datacoves.com" target="_blank">
          datacoves.com
         </a>
        </span>
       </div>
       <div class="footer-link">
        <span class="footer-links-policy">
         <a href="https://datacoves.com/privacy-policy" target="_blank">
          Policy
         </a>
        </span>
        <span class="footer-links-terms">
         <a href="https://datacoves.com/terms-of-service" target="_blank">
          Terms
         </a>
        </span>
       </div>
      </div>
     </footer>
    </div>
   </aside>
   <section class="content">
    <article class="markdown-section" id="main">
     <div style="overflow: auto">
      <p style="float: right">
       <a onclick="return editOnGitHub();" style="text-decoration: underline; cursor: pointer">
        Edit on github
       </a>
      </p>
     </div>
     <a name="statement-of-purpose">
     </a>
     <h1>
      Statement of Purpose
     </h1>
     <p>
      The purpose of this document is to describe the process of upgrading SSL certificates for customers that are using custom certificates (i.e. not using Let's Encrypt).
     </p>
     <a name="step-1-prepare-and-verify-certificate-files">
     </a>
     <h1>
      Step 1: Prepare and Verify Certificate Files
     </h1>
     <p>
      <em>
       This should be done soon after certificate files are received, and not last minute.
      </em>
     </p>
     <p>
      Ultimately, we need the following files:
     </p>
     <ul>
      <li>
       root.cer
      </li>
      <li>
       root.secret.key
      </li>
      <li>
       wildcard.cer
      </li>
      <li>
       wildcard.secret.key
      </li>
     </ul>
     <p>
      The root.cer is the certificate for the root domain, i.e. datacoves.orrum.com
     </p>
     <p>
      wildcard.cer is a wildcard, i.e. *.datacoves.orrum.com
     </p>
     <p>
      All of these files should be in pem format; the cer files should have the complete keychain.  A pem format looks like this:
     </p>
     <pre class="language-asc codehilite" data-lang="asc"><span></span><code class="language-asc"><span class="gh">-----BEGIN CERTIFICATE-----</span>
<span class="s">MIIEjTCCAvWgAwIBAgIQQ71EG0d4110tqpc8I8ur/jANBgkqhkiG9w0BAQsFADCB</span>
<span class="s">pzEeMBwGA1UEChMVbWtjZXJ0IGRldmVsb3BtZW50IENBMT4wPAYDVQQLDDVzc2Fz</span>
<span class="s">c2lAU2ViYXN0aWFucy1NYWNCb29rLVByby5sb2NhbCAoU2ViYXN0aWFuIFNhc3Np</span>
<span class="s">....</span>
<span class="s">JbszQlyzkyzBxQ5eiK3OUNdsB+n5Zo+TshRRL45wA9fZmvAizzmtehxJWUbidGL7</span>
<span class="s">eqqMWqdt11MTLJ3feOjGlryMFO6TIt/aH/91VkoLyVhsemuk5LukZ1nIxoWvzHcf</span>
<span class="s">y2cC+I3F8bWbYkRr92fmb8A=</span>
<span class="gh">-----END CERTIFICATE-----</span>
</code></pre>
     <p>
      There should be several BEGIN / END certificate blocks in wildcard.cer and root.cer file; the wildcard.csr and root.csr files should have a complete certificate stack and should be suspect if they only contain a single certificate block.
     </p>
     <p>
      The key files will have a slightly different header, looking like this:
     </p>
     <pre class="language-asc codehilite" data-lang="asc"><span></span><code class="language-asc"><span class="gh">-----BEGIN PRIVATE KEY-----</span>
<span class="s">MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCLf9Q17CQlOWDB</span>
<span class="s">CwWOuzL4+aalFwj2PR+OTuPnjHCI8stDedvmy5jtxSkdAL+5PgNu7ZJbKFhbODgT</span>
<span class="s">...</span>
<span class="s">OpuSfWnGVhOmii2aiYePtvNqDsLQv59MUxpUi8R6aw/XhG2Vb7t14+hbmUtRScUV</span>
<span class="s">LcGdNBdJyB8NaHYR/sNF1w==</span>
<span class="gh">-----END PRIVATE KEY-----</span>
</code></pre>
     <p>
      <em>
       If you receive a pfx format file, we cover that in a section below.  Read that section and go through those steps, then return to this section to complete verification.
      </em>
     </p>
     <p>
      You can verify the certs with the following commands:
     </p>
     <pre class="language-shell codehilite" data-lang="shell"><span></span><code class="language-shell"><span class="c1"># Verify root</span>
openssl<span class="w"> </span>crl2pkcs7<span class="w"> </span>-nocrl<span class="w"> </span>-certfile<span class="w"> </span>root.cer<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>pkcs7<span class="w"> </span>-print_certs<span class="w"> </span>-noout<span class="w"> </span>-text

<span class="c1"># Verify wildcard</span>
openssl<span class="w"> </span>crl2pkcs7<span class="w"> </span>-nocrl<span class="w"> </span>-certfile<span class="w"> </span>wildcard.cer<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>pkcs7<span class="w"> </span>-print_certs<span class="w"> </span>-noout<span class="w"> </span>-text
</code></pre>
     <p>
      And you will see several blocks with a Certificate header.  One block should contain the host name for the certificate.  In our example, datacoves.orrum.com:
     </p>
     <pre class="language-actionscript3 codehilite" data-lang="actionscript3"><span></span><code class="language-actionscript3"><span class="n">Certificate</span><span class="o">:</span>
<span class="w">    </span><span class="n">Data</span><span class="o">:</span>
<span class="w">        </span><span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">(</span><span class="mh">0x2</span><span class="o">)</span>
<span class="w">        </span><span class="n">Serial</span><span class="w"> </span><span class="n">Number</span><span class="o">:</span>
<span class="w">            </span><span class="mi">01</span><span class="o">:</span><span class="n">cb</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">21</span><span class="o">:</span><span class="mi">05</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">94</span><span class="o">:</span><span class="mi">76</span><span class="o">:</span><span class="mi">2</span><span class="n">b</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="mi">68</span><span class="o">:</span><span class="n">cf</span><span class="o">:</span><span class="mi">8</span><span class="n">a</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">4</span><span class="n">c</span><span class="o">:</span><span class="mi">02</span>
<span class="w">        </span><span class="n">Signature</span><span class="w"> </span><span class="n">Algorithm</span><span class="o">:</span><span class="w"> </span><span class="n">sha256WithRSAEncryption</span>
<span class="w">        </span><span class="n">Issuer</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">,</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Inc</span><span class="o">,</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="o">.</span><span class="na">digicert</span><span class="o">.</span><span class="na">com</span><span class="o">,</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">Thawte</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">RSA</span><span class="w"> </span><span class="n">CA</span><span class="w"> </span><span class="n">G1</span>
<span class="w">        </span><span class="n">Validity</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">Before</span><span class="o">:</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="w"> </span><span class="mi">2024</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">59</span><span class="w"> </span><span class="mi">2025</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">        </span><span class="n">Subject</span><span class="o">:</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">datacoves</span><span class="o">.</span><span class="na">orrum</span><span class="o">.</span><span class="na">com</span>
</code></pre>
     <p>
      Note the hostname under 'Subject'; make sure that is the correct host.  root will appear as above, as a single host name; wildcard should look like this instead:
     </p>
     <pre class="language-actionscript3 codehilite" data-lang="actionscript3"><span></span><code class="language-actionscript3"><span class="n">Certificate</span><span class="o">:</span>
<span class="w">    </span><span class="n">Data</span><span class="o">:</span>
<span class="w">        </span><span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">(</span><span class="mh">0x2</span><span class="o">)</span>
<span class="w">        </span><span class="n">Serial</span><span class="w"> </span><span class="n">Number</span><span class="o">:</span>
<span class="w">            </span><span class="mi">0</span><span class="n">d</span><span class="o">:</span><span class="mi">7</span><span class="n">f</span><span class="o">:</span><span class="n">e3</span><span class="o">:</span><span class="mi">36</span><span class="o">:</span><span class="mi">2</span><span class="n">c</span><span class="o">:</span><span class="n">db</span><span class="o">:</span><span class="n">b0</span><span class="o">:</span><span class="mi">65</span><span class="o">:</span><span class="mi">78</span><span class="o">:</span><span class="mi">9</span><span class="n">a</span><span class="o">:</span><span class="n">c1</span><span class="o">:</span><span class="mi">88</span><span class="o">:</span><span class="n">f8</span><span class="o">:</span><span class="mi">06</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">4</span><span class="n">f</span>
<span class="w">        </span><span class="n">Signature</span><span class="w"> </span><span class="n">Algorithm</span><span class="o">:</span><span class="w"> </span><span class="n">sha256WithRSAEncryption</span>
<span class="w">        </span><span class="n">Issuer</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">,</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Inc</span><span class="o">,</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="o">.</span><span class="na">digicert</span><span class="o">.</span><span class="na">com</span><span class="o">,</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">Thawte</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">RSA</span><span class="w"> </span><span class="n">CA</span><span class="w"> </span><span class="n">G1</span>
<span class="w">        </span><span class="n">Validity</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">Before</span><span class="o">:</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="w"> </span><span class="mi">2024</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">59</span><span class="w"> </span><span class="mi">2025</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">        </span><span class="n">Subject</span><span class="o">:</span><span class="w"> </span><span class="n">CN</span><span class="o">=*.</span><span class="n">datacoves</span><span class="o">.</span><span class="na">orrum</span><span class="o">.</span><span class="na">com</span>
</code></pre>
     <p>
      Note the * symbol there in the subject.  Also take note of the issuer;
      <code>
       CN=Thawte TLS RSA CA G1
      </code>
      .
     </p>
     <p>
      Elsewhere in the certificate output, you should see a certificate for the issuer, such as:
     </p>
     <pre class="language-actionscript3 codehilite" data-lang="actionscript3"><span></span><code class="language-actionscript3"><span class="n">Certificate</span><span class="o">:</span>
<span class="w">    </span><span class="n">Data</span><span class="o">:</span>
<span class="w">        </span><span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">(</span><span class="mh">0x2</span><span class="o">)</span>
<span class="w">        </span><span class="n">Serial</span><span class="w"> </span><span class="n">Number</span><span class="o">:</span>
<span class="w">            </span><span class="mi">09</span><span class="o">:</span><span class="mi">0</span><span class="n">e</span><span class="o">:</span><span class="n">e8</span><span class="o">:</span><span class="n">c5</span><span class="o">:</span><span class="n">de</span><span class="o">:</span><span class="mi">5</span><span class="n">b</span><span class="o">:</span><span class="n">fa</span><span class="o">:</span><span class="mi">62</span><span class="o">:</span><span class="n">d2</span><span class="o">:</span><span class="n">ae</span><span class="o">:</span><span class="mi">2</span><span class="n">f</span><span class="o">:</span><span class="n">f7</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mi">7</span><span class="n">c</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">57</span>
<span class="w">        </span><span class="n">Signature</span><span class="w"> </span><span class="n">Algorithm</span><span class="o">:</span><span class="w"> </span><span class="n">sha256WithRSAEncryption</span>
<span class="w">        </span><span class="n">Issuer</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">,</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Inc</span><span class="o">,</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="o">.</span><span class="na">digicert</span><span class="o">.</span><span class="na">com</span><span class="o">,</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Global</span><span class="w"> </span><span class="n">Root</span><span class="w"> </span><span class="n">G2</span>
<span class="w">        </span><span class="n">Validity</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">Before</span><span class="o">:</span><span class="w"> </span><span class="n">Nov</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mi">25</span><span class="w"> </span><span class="mi">2017</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nov</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mi">25</span><span class="w"> </span><span class="mi">2027</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">        </span><span class="n">Subject</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">,</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Inc</span><span class="o">,</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="o">.</span><span class="na">digicert</span><span class="o">.</span><span class="na">com</span><span class="o">,</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">Thawte</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">RSA</span><span class="w"> </span><span class="n">CA</span><span class="w"> </span><span class="n">G1</span>
</code></pre>
     <p>
      Note the subject matches the issuer name.  And finally, this certificate has an issuer as well; make sure that one is in the file.  In this case,
      <code>
       DigiCert Global Root G2
      </code>
      .  In our example, you can find it here:
     </p>
     <pre class="language-actionscript3 codehilite" data-lang="actionscript3"><span></span><code class="language-actionscript3"><span class="n">Certificate</span><span class="o">:</span>
<span class="w">    </span><span class="n">Data</span><span class="o">:</span>
<span class="w">        </span><span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">(</span><span class="mh">0x2</span><span class="o">)</span>
<span class="w">        </span><span class="n">Serial</span><span class="w"> </span><span class="n">Number</span><span class="o">:</span>
<span class="w">            </span><span class="mi">03</span><span class="o">:</span><span class="mi">3</span><span class="n">a</span><span class="o">:</span><span class="n">f1</span><span class="o">:</span><span class="n">e6</span><span class="o">:</span><span class="n">a7</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="n">a9</span><span class="o">:</span><span class="n">a0</span><span class="o">:</span><span class="n">bb</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">64</span><span class="o">:</span><span class="n">b1</span><span class="o">:</span><span class="mi">1</span><span class="n">d</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="n">fa</span><span class="o">:</span><span class="n">e5</span>
<span class="w">        </span><span class="n">Signature</span><span class="w"> </span><span class="n">Algorithm</span><span class="o">:</span><span class="w"> </span><span class="n">sha256WithRSAEncryption</span>
<span class="w">        </span><span class="n">Issuer</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">,</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Inc</span><span class="o">,</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="o">.</span><span class="na">digicert</span><span class="o">.</span><span class="na">com</span><span class="o">,</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Global</span><span class="w"> </span><span class="n">Root</span><span class="w"> </span><span class="n">G2</span>
<span class="w">        </span><span class="n">Validity</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">Before</span><span class="o">:</span><span class="w"> </span><span class="n">Aug</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="w"> </span><span class="mi">2013</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="n">Not</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Jan</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="w"> </span><span class="mi">2038</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">        </span><span class="n">Subject</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">,</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Inc</span><span class="o">,</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">www</span><span class="o">.</span><span class="na">digicert</span><span class="o">.</span><span class="na">com</span><span class="o">,</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">DigiCert</span><span class="w"> </span><span class="n">Global</span><span class="w"> </span><span class="n">Root</span><span class="w"> </span><span class="n">G2</span>
</code></pre>
     <p>
      Note again the 'subject' line.  Typically PEM files will have certificates in the following order:
     </p>
     <ul>
      <li>
       Host's certificate
      </li>
      <li>
       One or More Intermediate
      </li>
      <li>
       Root certificate
      </li>
     </ul>
     <p>
      If you have to assemble a certificate from multiple parts, please be aware that this is the recommended ordering; however I don't think it will cause an error if you get the ordering wrong.
     </p>
     <p>
      Once your certificates are in order, you can verify the key with the following commands:
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text">openssl rsa -check -noout -in wildcard.secret.key
openssl rsa -check -noout -in root.secret.key
</code></pre>
     <p>
      Both should say:
      <code>
       RSA key is okay
      </code>
     </p>
     <p>
      Now compare the modulus of the key and the cert:
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text"># These two should match
openssl rsa -modulus -noout -in wildcard.secret.key | openssl md5
openssl x509 -modulus -noout -in wildcard.cer | openssl md5

# And these two should match
openssl rsa -modulus -noout -in root.secret.key | openssl md5
openssl x509 -modulus -noout -in root.cer | openssl md5
</code></pre>
     <p>
      If the modulus doesn't match, it may be because the server certificate isn't the first certificate in the .cer file.  Make sure the order is correct and try again.
     </p>
     <a name="converting-pfx-format-files">
     </a>
     <h2>
      Converting pfx format files
     </h2>
     <p>
      We have received files in pfx format instead of pem and these require special handling.  Follow the following directions to convert them to usable cer and key files, then use the following commands:
     </p>
     <pre class="language-shell codehilite" data-lang="shell"><span></span><code class="language-shell"><span class="c1"># Assuming we have files wildcard.pfx and root.pfx</span>
<span class="c1">#</span>
<span class="c1"># Note: The --legacy option seems to be needed for most people, however</span>
<span class="c1">#       some are able to do this without --legacy ... you can try without</span>
<span class="c1">#       it first if you want.</span>
<span class="c1">#</span>
<span class="c1"># You will be asked for an "Import Password" -- just hit enter to skip that</span>
<span class="c1"># If you get an error after the Import Password, you need --legacy</span>

openssl<span class="w"> </span>pkcs12<span class="w"> </span>-in<span class="w"> </span>wildcard.pfx<span class="w"> </span>-cacerts<span class="w"> </span>-out<span class="w"> </span>wildcard_ca.cer<span class="w"> </span>-nodes<span class="w"> </span>-nokeys<span class="w"> </span>--legacy
openssl<span class="w"> </span>pkcs12<span class="w"> </span>-in<span class="w"> </span>root.pfx<span class="w"> </span>-cacerts<span class="w"> </span>-out<span class="w"> </span>root_ca.cer<span class="w"> </span>-nodes<span class="w"> </span>-nokeys<span class="w"> </span>--legacy
</code></pre>
     <p>
      Edit the wildcard.cer and root.cer files, and remove the header above
      <code>
       -----BEGIN CERTIFICATE-----
      </code>
      .  This header will resemble this:
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text">Bag Attributes: &lt;No Attributes&gt;
subject=C=US, O=DigiCert Inc, OU=www.digicert.com, CN=Thawte TLS RSA CA G1
issuer=C=US, O=DigiCert Inc, OU=www.digicert.com, CN=DigiCert Global Root G2
</code></pre>
     <p>
      <em>
       WARNING: Check the ENTIRE file, as there will probably be multiple of the headers.  Any text not between
       <code>
        -----BEGIN CERTIFICATE-----
       </code>
       and
       <code>
        -----END CERTIFICATE-----
       </code>
       must be removed!
      </em>
     </p>
     <p>
      Next, you need to extract the server certs, thusly:
     </p>
     <pre class="language-verilog codehilite" data-lang="verilog"><span></span><code class="language-verilog"><span class="p">#</span><span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">notes</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">regarding</span><span class="w"> </span><span class="o">--</span><span class="n">legacy</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="s">"Import Password"</span>

<span class="n">openssl</span><span class="w"> </span><span class="n">pkcs12</span><span class="w"> </span><span class="o">-</span><span class="n">in</span><span class="w"> </span><span class="n">wildcard</span><span class="p">.</span><span class="n">pfx</span><span class="w"> </span><span class="o">-</span><span class="n">clcerts</span><span class="w"> </span><span class="o">-</span><span class="n">nokeys</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">wildcard</span><span class="p">.</span><span class="n">single</span><span class="p">.</span><span class="n">cer</span><span class="w"> </span><span class="o">--</span><span class="n">legacy</span>
<span class="n">openssl</span><span class="w"> </span><span class="n">pkcs12</span><span class="w"> </span><span class="o">-</span><span class="n">in</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="n">pfx</span><span class="w"> </span><span class="o">-</span><span class="n">clcerts</span><span class="w"> </span><span class="o">-</span><span class="n">nokeys</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">wildcard</span><span class="p">.</span><span class="n">single</span><span class="p">.</span><span class="n">cer</span><span class="w"> </span><span class="o">--</span><span class="n">legacy</span>
</code></pre>
     <p>
      Once again, delete the header(s) above
      <code>
       -----BEGIN CERTIFICATE-----
      </code>
      in these files.  Afterwards, run the following command:
     </p>
     <pre class="language-scdoc codehilite" data-lang="scdoc"><span></span><code class="language-scdoc">cat wildcard.single.cer wildcard_ca.cer &gt; wildcard.cer
cat root.single.cer root_ca.cer &gt; root.cer
</code></pre>
     <p>
      Now we're going to generate the private keys.  When generating the private keys, set a temporary password (just the word
      <code>
       password
      </code>
      is fine); we will remove the password in the subsequent step.
     </p>
     <pre class="language-verilog codehilite" data-lang="verilog"><span></span><code class="language-verilog"><span class="p">#</span><span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">notes</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">regarding</span><span class="w"> </span><span class="o">--</span><span class="n">legacy</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="s">"Import Password"</span>
<span class="n">openssl</span><span class="w"> </span><span class="n">pkcs12</span><span class="w"> </span><span class="o">-</span><span class="n">in</span><span class="w"> </span><span class="n">wildcard</span><span class="p">.</span><span class="n">pfx</span><span class="w"> </span><span class="o">-</span><span class="n">nocerts</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">wildcard</span><span class="p">.</span><span class="n">secrets</span><span class="p">.</span><span class="n">withpass</span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="o">--</span><span class="n">legacy</span>
<span class="n">openssl</span><span class="w"> </span><span class="n">pkcs12</span><span class="w"> </span><span class="o">-</span><span class="n">in</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="n">pfx</span><span class="w"> </span><span class="o">-</span><span class="n">nocerts</span><span class="w"> </span><span class="o">-</span><span class="n">out</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="n">secrets</span><span class="p">.</span><span class="n">withpass</span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="o">--</span><span class="n">legacy</span>
</code></pre>
     <p>
      And finally, strip the passwords out for the final key files:
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text">openssl rsa -in wildcard.secrets.withpass.key -out wildcard.secret.key
openssl rsa -in root.secrets.withpass.key -out root.secret.key
</code></pre>
     <p>
      Now you have the files in PEM format, and you can go back to the section above to verify them.
     </p>
     <a name="step-2-update-cluster">
     </a>
     <h1>
      Step 2: Update Cluster
     </h1>
     <p>
      This step may vary from customer to customer, so see the appropriate subsection.
     </p>
     <a name="orrum">
     </a>
     <h2>
      Orrum
     </h2>
     <p>
      First, make sure you have the configuration repository checked out.  In your
      <code>
       config
      </code>
      directory, clone it thusly:
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text">git clone https://github.com/datacoves/config-datacoves-orrum.git datacoves.orrum.com
</code></pre>
     <p>
      In the
      <code>
       datacoves.orrum.com
      </code>
      directory, reveal the secrets.  If you call this command within a sub directory, you'll get an error about
      <code>
       core-api.env.secret
      </code>
      cannot be found.
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text">git secret reveal -f
</code></pre>
     <p>
      TODO: add instructions for setting up git secret
     </p>
     <p>
      Then in the
      <code>
       base
      </code>
      directory you will find
      <code>
       root.cer
      </code>
      ,
      <code>
       root.secret.key
      </code>
      ,
      <code>
       wildcard.cer
      </code>
      , and
      <code>
       wildcard.secret.key
      </code>
      .  Replace these files with the new, verified files from step 1.
     </p>
     <p>
      Connect to the Orrum VPN.  Instructions are here: https://github.com/datacoves/datacoves/tree/main/docs/client-docs/orrum
     </p>
     <p>
      Make sure you are in your Orrum context, whatever that is named:
     </p>
     <pre class="language-scdoc codehilite" data-lang="scdoc"><span></span><code class="language-scdoc"><span class="gh">#</span> Use:
<span class="gh">#</span> kubectl config get-contexts
<span class="gh">#</span> To get context list if needed.
kubectl config use-context orrum_new
</code></pre>
     <p>
      Then run setup base.  Return to the root directory of your git checkout to run
      <code>
       cli.py
      </code>
      thusly:
     </p>
     <pre class="language-scdoc codehilite" data-lang="scdoc"><span></span><code class="language-scdoc"><span class="gh">#</span> Activate your venv first if necessary
./cli.py setup_base
</code></pre>
     <p>
      After the cluster is updated (ingress will be updated), check the certificate:
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text">curl https://api.datacoves.orrum.com -vI
</code></pre>
     <p>
      This should output a bunch of information about the certificate, including:
     </p>
     <pre class="language-css+lasso codehilite" data-lang="css+lasso"><span></span><code class="language-css+lasso"><span class="o">*</span><span class="w"> </span><span class="nt">Server</span><span class="w"> </span><span class="nt">certificate</span><span class="o">:</span>
<span class="o">*</span><span class="w">  </span><span class="nt">subject</span><span class="o">:</span><span class="w"> </span><span class="nt">CN</span><span class="o">=*</span><span class="p">.</span><span class="nc">datacoves</span><span class="p">.</span><span class="nc">orrum</span><span class="p">.</span><span class="nc">com</span>
<span class="o">*</span><span class="w">  </span><span class="nt">start</span><span class="w"> </span><span class="nt">date</span><span class="o">:</span><span class="w"> </span><span class="nt">Apr</span><span class="w">  </span><span class="nt">8</span><span class="w"> </span><span class="nt">07</span><span class="p">:</span><span class="nd">33</span><span class="p">:</span><span class="nd">48</span><span class="w"> </span><span class="nt">2024</span><span class="w"> </span><span class="nt">GMT</span>
<span class="o">*</span><span class="w">  </span><span class="nt">expire</span><span class="w"> </span><span class="nt">date</span><span class="o">:</span><span class="w"> </span><span class="nt">Jul</span><span class="w">  </span><span class="nt">1</span><span class="w"> </span><span class="nt">07</span><span class="p">:</span><span class="nd">33</span><span class="p">:</span><span class="nd">47</span><span class="w"> </span><span class="nt">2024</span><span class="w"> </span><span class="nt">GMT</span>
<span class="o">*</span><span class="w">  </span><span class="nt">subjectAltName</span><span class="o">:</span><span class="w"> </span><span class="nt">host</span><span class="w"> </span><span class="s2">"api.datacoves.orrum.com"</span><span class="w"> </span><span class="nt">matched</span><span class="w"> </span><span class="nt">cert</span><span class="err">'</span><span class="nt">s</span><span class="w"> </span><span class="s2">"*.datacoves.orrum.com"</span>
<span class="o">*</span><span class="w">  </span><span class="nt">issuer</span><span class="o">:</span><span class="w"> </span><span class="nt">C</span><span class="o">=</span><span class="nt">US</span><span class="o">;</span><span class="w"> </span><span class="nt">O</span><span class="o">=</span><span class="nt">DigiCert</span><span class="w"> </span><span class="nt">Inc</span><span class="o">;</span><span class="w"> </span><span class="nt">OU</span><span class="o">=</span><span class="nt">www</span><span class="p">.</span><span class="nc">digicert</span><span class="p">.</span><span class="nc">com</span><span class="o">;</span><span class="w"> </span><span class="nt">CN</span><span class="o">=</span><span class="nt">Thawte</span><span class="w"> </span><span class="nt">TLS</span><span class="w"> </span><span class="nt">RSA</span><span class="w"> </span><span class="nt">CA</span><span class="w"> </span><span class="nt">G1</span>
<span class="o">*</span><span class="w">  </span><span class="nt">SSL</span><span class="w"> </span><span class="nt">certificate</span><span class="w"> </span><span class="nt">verify</span><span class="w"> </span><span class="nt">ok</span><span class="o">.</span>
</code></pre>
     <p>
      (The CN should be the correct host, and the expire date should be correct).
     </p>
     <p>
      Check the non-wildcard version as well:
     </p>
     <pre class="language-text codehilite" data-lang="text"><span></span><code class="language-text">curl https://datacoves.orrum.com -vI
</code></pre>
     <p>
      Log into Orrum's launchpad and go into one of the environments to make sure pomerium doesn't have any issues; pomerium is particularly sensitive to certificate problems such as not having the full certificate chain in the root.cer / wildcard.cer files.
     </p>
     <p>
      If everything works alright, let's push the secrets.  Be careful to not push up the key files as they will show up as "Untracked Files" in a
      <code>
       git status
      </code>
      .  It is recommended you manually add the files thusly:
     </p>
     <pre class="language-tsql codehilite" data-lang="tsql"><span></span><code class="language-tsql"><span class="err">#</span><span class="w"> </span><span class="k">Go</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">directory</span>
<span class="n">cd</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">datacoves</span><span class="p">.</span><span class="n">orrum</span><span class="p">.</span><span class="n">com</span>

<span class="err">#</span><span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">changed</span>
<span class="n">git</span><span class="w"> </span><span class="n">status</span>

<span class="err">#</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="p">.</span><span class="n">pfx</span>
<span class="n">git</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="p">.</span><span class="n">gitsecret</span><span class="o">/</span><span class="n">paths</span><span class="o">/</span><span class="n">mapping</span><span class="p">.</span><span class="n">cfg</span><span class="w"> </span><span class="n">base</span><span class="o">/</span><span class="n">root</span><span class="p">.</span><span class="n">cer</span><span class="w"> </span><span class="n">base</span><span class="o">/</span><span class="n">wildcard</span><span class="p">.</span><span class="n">cer</span><span class="w"> </span><span class="n">secrets</span><span class="o">/</span><span class="n">core</span><span class="o">-</span><span class="n">api</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">secret</span><span class="w"> </span><span class="n">secrets</span><span class="o">/</span><span class="n">docker</span><span class="o">-</span><span class="n">config</span><span class="p">.</span><span class="n">secret</span><span class="p">.</span><span class="n">json</span><span class="p">.</span><span class="n">secret</span><span class="w"> </span><span class="n">secrets</span><span class="o">/</span><span class="n">rabbitmq</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">secert</span>

<span class="err">#</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">safe</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">modified</span><span class="p">,</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">keys</span><span class="err">!</span>

<span class="n">git</span><span class="w"> </span><span class="k">commit</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="ss">"Update certificates"</span>
<span class="n">git</span><span class="w"> </span><span class="n">push</span>
</code></pre>
     <p>
      And it should be done!
     </p>
    </article>
   </section>
  </main>
  <div class="progress" style="opacity: 0; width: 0%;">
  </div>
 </body>
 <script src="https://code.jquery.com/jquery-3.7.1.min.js">
 </script>
 <script src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js">
 </script>
 <script src="/assets/custom.js">
 </script>
</html>
